name: sender

deployments:
- containers:
  - image: docker.io/surajd/activemq-sender:1.0.1
    env:
    - name: AMQP_USERNAME
      value: deployments
    - name: AMQP_PASSWORD
      value: test
    - name: POD_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.name
    - name: TYPE_OF_AMQP_USER
      value: sender
    - name: "AMQP_ADDRESS"
      value: "sender.receiver1,sender.receiver2"

---
name: receiver1

deployments:
- containers:
  - image: docker.io/surajd/activemq-receiver1:1.0.1
    env:
    - name: AMQP_USERNAME
      value: deployments
    - name: AMQP_PASSWORD
      value: test
    - name: POD_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.name
    - name: TYPE_OF_AMQP_USER
      value: receiver1
    - name: "AMQP_ADDRESS"
      value: "sender.receiver1"

---
name: receiver2

deployments:
- replicas: 2
  containers:
  - image: docker.io/surajd/activemq-receiver2:1.0.1
    env:
    - name: AMQP_USERNAME
      value: deployments
    - name: AMQP_PASSWORD
      value: test
    - name: POD_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.name
    - name: TYPE_OF_AMQP_USER
      value: receiver2
    - name: "AMQP_ADDRESS"
      value: "sender.receiver2"
